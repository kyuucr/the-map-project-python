cell_table_2_4 = [
    # ( Channel num, Center freq MHz, Start freq MHz, End freq MHz, Width MHz)
    (1, 2412, 2401, 2423, 22),
    (2, 2417, 2406, 2428, 22),
    (3, 2422, 2411, 2433, 22),
    (4, 2427, 2416, 2438, 22),
    (5, 2432, 2421, 2443, 22),
    (6, 2437, 2426, 2448, 22),
    (7, 2442, 2431, 2453, 22),
    (8, 2447, 2436, 2458, 22),
    (9, 2452, 2441, 2463, 22),
    (10, 2457, 2446, 2468, 22),
    (11, 2462, 2451, 2473, 22),
    (12, 2467, 2456, 2478, 22),
    (13, 2472, 2461, 2483, 22),
    (14, 2484, 2473, 2495, 22)
]
cell_table_5 = [
    # ( Channel num, Center freq MHz, Start freq MHz, End freq MHz, Width MHz)
    (7, 5035, 5030, 5040, 10),
    (8, 5040, 5030, 5050, 20),
    (9, 5045, 5040, 5050, 10),
    (11, 5055, 5050, 5060, 10),
    (12, 5060, 5050, 5070, 20),
    (16, 5080, 5070, 5090, 20),
    (32, 5160, 5150, 5170, 20),
    (34, 5170, 5150, 5190, 40),
    (36, 5180, 5170, 5190, 20),
    (38, 5190, 5170, 5210, 40),
    (40, 5200, 5190, 5210, 20),
    (42, 5210, 5170, 5250, 80),
    (44, 5220, 5210, 5230, 20),
    (46, 5230, 5210, 5250, 40),
    (48, 5240, 5230, 5250, 20),
    (50, 5250, 5170, 5330, 160),
    (52, 5260, 5250, 5270, 20),
    (54, 5270, 5250, 5290, 40),
    (56, 5280, 5270, 5290, 20),
    (58, 5290, 5250, 5330, 80),
    (60, 5300, 5290, 5310, 20),
    (62, 5310, 5290, 5330, 40),
    (64, 5320, 5310, 5330, 20),
    (68, 5340, 5330, 5350, 20),
    (96, 5480, 5470, 5490, 20),
    (100, 5500, 5490, 5510, 20),
    (102, 5510, 5490, 5530, 40),
    (104, 5520, 5510, 5530, 20),
    (106, 5530, 5490, 5570, 80),
    (108, 5540, 5530, 5550, 20),
    (110, 5550, 5530, 5570, 40),
    (112, 5560, 5550, 5570, 20),
    (114, 5570, 5490, 5650, 160),
    (116, 5580, 5570, 5590, 20),
    (118, 5590, 5570, 5610, 40),
    (120, 5600, 5590, 5610, 20),
    (122, 5610, 5570, 5650, 80),
    (124, 5620, 5610, 5630, 20),
    (126, 5630, 5610, 5650, 40),
    (128, 5640, 5630, 5650, 20),
    (132, 5660, 5650, 5670, 20),
    (134, 5670, 5650, 5690, 40),
    (136, 5680, 5670, 5690, 20),
    (138, 5690, 5650, 5730, 80),
    (140, 5700, 5690, 5710, 20),
    (142, 5710, 5690, 5730, 40),
    (144, 5720, 5710, 5730, 20),
    (149, 5745, 5735, 5755, 20),
    (151, 5755, 5735, 5775, 40),
    (153, 5765, 5755, 5775, 20),
    (155, 5775, 5735, 5815, 80),
    (157, 5785, 5775, 5795, 20),
    (159, 5795, 5775, 5815, 40),
    (161, 5805, 5795, 5815, 20),
    (163, 5815, 5735, 5895, 160),
    (165, 5825, 5815, 5835, 20),
    (167, 5835, 5815, 5855, 40),
    (169, 5845, 5835, 5855, 20),
    (171, 5855, 5815, 5895, 80),
    (172, 5860, 5855, 5865, 10),
    (173, 5865, 5855, 5875, 20),
    (174, 5860, 5865, 5875, 10),
    (175, 5875, 5855, 5895, 40),
    (176, 5880, 5875, 5885, 10),
    (177, 5885, 5875, 5895, 20),
    (178, 5890, 5885, 5895, 10),
    (180, 5900, 5895, 5905, 10),
    (182, 5910, 5905, 5915, 10),
    (183, 5915, 5905, 5925, 20),
    (184, 5920, 5915, 5925, 10),
    (187, 5935, 5930, 5940, 10),
    (188, 5940, 5930, 5950, 20),
    (189, 5945, 5940, 5950, 10),
    (192, 5960, 5950, 5970, 20),
    (196, 5980, 5970, 5990, 20)
]
cell_table_6 = [
    # ( Channel num, Center freq MHz, Start freq MHz, End freq MHz, Width MHz)
    (1, 5955, 5945, 5965, 20),
    (2, 5935, 5925, 5945, 20),
    (3, 5965, 5945, 5985, 40),
    (5, 5975, 5965, 5985, 20),
    (7, 5985, 5945, 6025, 80),
    (9, 5995, 5985, 6005, 20),
    (11, 6005, 5985, 6025, 40),
    (13, 6015, 6005, 6025, 20),
    (15, 6025, 5945, 6105, 160),
    (17, 6035, 6025, 6045, 20),
    (19, 6045, 6025, 6065, 40),
    (21, 6055, 6045, 6065, 20),
    (23, 6065, 6025, 6105, 80),
    (25, 6075, 6065, 6085, 20),
    (27, 6085, 6065, 6105, 40),
    (29, 6095, 6085, 6105, 20),
    (31, 6105, 5945, 6265, 320),
    (33, 6115, 6105, 6125, 20),
    (35, 6125, 6105, 6145, 40),
    (37, 6135, 6125, 6145, 20),
    (39, 6145, 6105, 6185, 80),
    (41, 6155, 6145, 6165, 20),
    (43, 6165, 6145, 6185, 40),
    (45, 6175, 6165, 6185, 20),
    (47, 6185, 6105, 6265, 160),
    (49, 6195, 6185, 6205, 20),
    (51, 6205, 6185, 6225, 40),
    (53, 6215, 6205, 6225, 20),
    (55, 6225, 6185, 6265, 80),
    (57, 6235, 6225, 6245, 20),
    (59, 6245, 6225, 6265, 40),
    (61, 6255, 6245, 6265, 20),
    (63, 6265, 6105, 6425, 320),
    (65, 6275, 6265, 6285, 20),
    (67, 6285, 6265, 6305, 40),
    (69, 6295, 6285, 6305, 20),
    (71, 6305, 6265, 6345, 80),
    (73, 6315, 6305, 6325, 20),
    (75, 6325, 6305, 6345, 40),
    (77, 6335, 6325, 6345, 20),
    (79, 6345, 6265, 6425, 160),
    (81, 6355, 6345, 6365, 20),
    (83, 6365, 6345, 6385, 40),
    (85, 6375, 6365, 6385, 20),
    (87, 6385, 6345, 6425, 80),
    (89, 6395, 6385, 6405, 20),
    (91, 6405, 6385, 6425, 40),
    (93, 6415, 6405, 6425, 20),
    (95, 6425, 6265, 6585, 320),
    (97, 6435, 6425, 6445, 20),
    (99, 6445, 6425, 6465, 40),
    (101, 6455, 6445, 6465, 20),
    (103, 6465, 6425, 6505, 80),
    (105, 6475, 6465, 6485, 20),
    (107, 6485, 6465, 6505, 40),
    (109, 6495, 6485, 6505, 20),
    (111, 6505, 6425, 6585, 160),
    (113, 6515, 6505, 6525, 20),
    (115, 6525, 6505, 6545, 40),
    (117, 6535, 6525, 6545, 20),
    (119, 6545, 6505, 6585, 80),
    (121, 6555, 6545, 6565, 20),
    (123, 6565, 6545, 6585, 40),
    (125, 6575, 6565, 6585, 20),
    (127, 6585, 6425, 6745, 320),
    (129, 6595, 6585, 6605, 20),
    (131, 6605, 6585, 6625, 40),
    (133, 6615, 6605, 6625, 20),
    (135, 6625, 6585, 6665, 80),
    (137, 6635, 6625, 6645, 20),
    (139, 6645, 6625, 6665, 40),
    (141, 6655, 6645, 6665, 20),
    (143, 6665, 6585, 6745, 160),
    (145, 6675, 6665, 6685, 20),
    (147, 6685, 6665, 6705, 40),
    (149, 6695, 6685, 6705, 20),
    (151, 6705, 6665, 6745, 80),
    (153, 6715, 6705, 6725, 20),
    (155, 6725, 6705, 6745, 40),
    (157, 6735, 6725, 6745, 20),
    (159, 6745, 6585, 6905, 320),
    (161, 6755, 6745, 6765, 20),
    (163, 6765, 6745, 6785, 40),
    (165, 6775, 6765, 6785, 20),
    (167, 6785, 6745, 6825, 80),
    (169, 6795, 6785, 6805, 20),
    (171, 6805, 6785, 6825, 40),
    (173, 6815, 6805, 6825, 20),
    (175, 6825, 6745, 6905, 160),
    (177, 6835, 6825, 6845, 20),
    (179, 6845, 6825, 6865, 40),
    (181, 6855, 6845, 6865, 20),
    (183, 6865, 6825, 6905, 80),
    (185, 6875, 6865, 6885, 20),
    (187, 6885, 6865, 6905, 40),
    (189, 6895, 6885, 6905, 20),
    (191, 6905, 6745, 7065, 320),
    (193, 6915, 6905, 6925, 20),
    (195, 6925, 6905, 6945, 40),
    (197, 6935, 6925, 6945, 20),
    (199, 6945, 6905, 6985, 80),
    (201, 6955, 6945, 6965, 20),
    (203, 6965, 6945, 6985, 40),
    (205, 6975, 6965, 6985, 20),
    (207, 6985, 6905, 7065, 160),
    (209, 6995, 6985, 7005, 20),
    (211, 7005, 6985, 7025, 40),
    (213, 7015, 7005, 7025, 20),
    (215, 7025, 6985, 7065, 80),
    (217, 7035, 7025, 7045, 20),
    (219, 7045, 7025, 7065, 40),
    (221, 7055, 7045, 7065, 20),
    (225, 7075, 7065, 7085, 20),
    (227, 7085, 7065, 7105, 40),
    (229, 7095, 7085, 7105, 20),
    (233, 7115, 7105, 7125, 20)
]


def get_freq_code(freq):
    match freq:
        case num if num in range(2401, 2495):
            return "2.4"
        case num if num in range(5150, 5925):
            return "5"
        case num if num in range(5926, 7125):
            return "6"
        case _:
            return "unknown"


def get_channel_from_num(freq_code, ch_num):
    ch = None
    # cell_table = list()
    match freq_code:
        case "2.4":
            cell_table = cell_table_2_4
        case "5":
            cell_table = cell_table_5
        case "6":
            cell_table = cell_table_6

    ch_list = next((x for x in cell_table if x[0] == ch_num), None)
    if ch_list:
        ch = ch_list[0]
    return ch


def get_channel_from_freq(freq, width):
    ch = None
    cell_table = list()
    freq_code = get_freq_code(freq)
    match freq_code:
        case "2.4":
            cell_table = cell_table_2_4
        case "5":
            cell_table = cell_table_5
        case "6":
            cell_table = cell_table_6

    ch_list = next(
        (x for x in cell_table if freq in range(x[2], x[3]) and x[4] == width),
        None)
    if ch_list:
        ch = ch_list[0]
    return ch
